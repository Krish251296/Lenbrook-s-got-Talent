<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Leaderboard ‚ùÑÔ∏è Lenbrook‚Äôs Got Talent</title>
  <style>
    :root {
      --bg-start: #4a0029;
      --bg-end:   #d69a2e;
      --card-bg: rgba(255,255,255,0.15);
      --card-border: rgba(255,255,255,0.3);
      --text-main: #fff;
      --accent: #ffd983;
      --radius-lg: 20px;
      --radius-sm: 10px;
      --shadow-card: 0 30px 60px rgba(0,0,0,0.5);
      --glass-blur: blur(12px);
      --font-stack: "Inter", system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;
    }

    *{box-sizing:border-box;-webkit-font-smoothing:antialiased;}
    body{
      margin:0;
      min-height:100vh;
      color:var(--text-main);
      font-family:var(--font-stack);
      background: radial-gradient(circle at 20% 20%, rgba(255,255,255,0.08) 0%, rgba(0,0,0,0) 60%),
                  linear-gradient(135deg,var(--bg-start)0%,var(--bg-end)100%);
      position:relative;
      overflow-x:hidden;
    }

    .snow{
      pointer-events:none;
      position:fixed;
      inset:0;
      background-image:
        radial-gradient(circle at 10px 10px,rgba(255,255,255,0.9)2px,transparent 3px),
        radial-gradient(circle at 50px 30px,rgba(255,255,255,0.6)1.5px,transparent 3px),
        radial-gradient(circle at 90px 60px,rgba(255,255,255,0.8)2px,transparent 3px);
      background-size:120px 120px;
      opacity:.4;
      animation:snowDrift 8s linear infinite;
      z-index:2;
    }
    @keyframes snowDrift{
      0%{background-position:0px 0px,0px 0px,0px 0px;}
      100%{background-position:0px 120px,0px 120px,0px 120px;}
    }

    .corner-logo{
      position:fixed;
      top:16px;left:16px;
      z-index:10;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .corner-logo img{
      height:56px;width:auto;
      filter:drop-shadow(0 10px 20px rgba(0,0,0,.6));
    }
    .corner-logo .tagline{
      font-size:.8rem;
      font-weight:500;
      color:var(--accent);
      line-height:1.2;
      text-shadow:0 2px 4px rgba(0,0,0,.7);
    }
    .corner-santa{
      position:fixed;
      top:16px;
      right:16px;
      z-index:10;
    }
    .corner-santa img{
      height:64px;width:auto;
      filter:drop-shadow(0 12px 24px rgba(0,0,0,.8));
    }
    .corner-psb{
      position:fixed;
      left:16px;
      bottom:16px;
      z-index:10;
    }
    .corner-psb img{
      height:60px;width:auto;
      filter:drop-shadow(0 12px 24px rgba(0,0,0,.8));
    }

    .page-shell{
      position:relative;
      z-index:5;
      min-height:100vh;
      padding:110px 16px 80px;
      max-width:900px;
      margin:0 auto;
    }

    .header-card{
      background:var(--card-bg);
      border:1px solid var(--card-border);
      box-shadow:var(--shadow-card);
      backdrop-filter:var(--glass-blur);
      border-radius:var(--radius-lg);
      padding:20px;
      text-align:center;
      margin-bottom:20px;
    }
    .title{
      margin:0;
      font-size:1.2rem;
      font-weight:600;
      color:var(--accent);
      text-shadow:0 2px 4px rgba(0,0,0,.8);
    }
    .subtitle{
      margin:6px 0 0;
      font-size:.8rem;
      color:#fff;
      opacity:.8;
      text-shadow:0 2px 4px rgba(0,0,0,.8);
      font-weight:400;
    }
    #status{
      margin-top:10px;
      font-size:.8rem;
      font-weight:500;
      color:#fff;
      text-shadow:0 2px 4px rgba(0,0,0,.8);
    }

    /* leaderboard list */
    .list-area{
      display:grid;
      gap:16px;
    }
    .entry-card{
      display:flex;
      flex-wrap:wrap;
      justify-content:space-between;
      align-items:flex-start;
      background:var(--card-bg);
      border:1px solid var(--card-border);
      box-shadow:var(--shadow-card);
      backdrop-filter:var(--glass-blur);
      border-radius:var(--radius-lg);
      padding:16px 20px;
      color:#fff;
      text-shadow:0 2px 4px rgba(0,0,0,.8);
    }
    .left-col{
      flex:1 1 220px;
      min-width:0;
    }
    .rank-line{
      font-size:.75rem;
      font-weight:600;
      color:var(--accent);
      margin-bottom:4px;
    }
    .team-line{
      font-size:1rem;
      font-weight:600;
      color:#fff;
      word-break:break-word;
    }
    .collab-line{
      font-size:.75rem;
      opacity:.8;
      word-break:break-word;
    }
    .desc-line{
      font-size:.75rem;
      opacity:.9;
      margin-top:6px;
      word-break:break-word;
    }

    .mid-col{
      flex:0 0 auto;
      margin:12px 20px 0 0;
    }
    video{
      width:160px;
      max-width:40vw;
      border-radius:var(--radius-sm);
      box-shadow:0 20px 40px rgba(0,0,0,.8);
    }

    .right-col{
      flex:0 0 100px;
      text-align:right;
      font-size:.8rem;
      font-weight:600;
      min-width:100px;
      color:var(--accent);
    }
    .score-big{
      font-size:1.6rem;
      line-height:1.2;
      color:#fff;
      text-shadow:0 3px 6px rgba(0,0,0,.9);
    }
    .score-label{
      font-size:.7rem;
      font-weight:500;
      opacity:.8;
      color:#fff;
    }

    @media(max-width:600px){
      .entry-card{flex-direction:column;}
      .mid-col{order:3;margin:16px 0 0;}
      .right-col{
        order:2;
        align-self:flex-start;
        text-align:left;
        margin-top:8px;
      }
    }
  </style>
</head>
<body>
  <div class="snow"></div>

  <div class="corner-logo">
    <img src="logo.png" alt="Lenbrook's Got Talent Logo">
    <div class="tagline">
      Presented by Party Patrol<br/>Holiday Showcase 2025
    </div>
  </div>
  <div class="corner-santa">
    <img src="santa.png" alt="Santa">
  </div>
  <div class="corner-psb">
    <img src="psb.png" alt="PSB Headphones">
  </div>

  <div class="page-shell">
    <div class="header-card">
      <h2 class="title">üéñ Live Leaderboard</h2>
      <p class="subtitle">Ranked by average judge score</p>
      <div id="status">Loading...</div>
    </div>

    <div class="list-area" id="leaderboardList"></div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCzXbIghLheIWJHEgCCI_oOe5finmUIe1U",
      authDomain: "lenbrook-s-got-talent.firebaseapp.com",
      projectId: "lenbrook-s-got-talent",
      storageBucket: "lenbrook-s-got-talent.firebasestorage.app",
      messagingSenderId: "327419181483",
      appId: "1:327419181483:web:c78bde1ba35d3bf037faee"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const listEl = document.getElementById("leaderboardList");
    const statusEl = document.getElementById("status");

    async function loadLeaderboard() {
      const snap = await getDocs(collection(db, "submissions"));

      const entries = [];
      snap.forEach(docSnap => {
        const data = docSnap.data();
        entries.push({
          id: docSnap.id,
          name: data.name || "",
          department: data.department || "",
          description: data.description || "",
          videoURL: data.videoURL || "",
          avg: data.averageScore || 0
        });
      });

      // sort desc by avg score
      entries.sort((a,b)=> b.avg - a.avg);

      listEl.innerHTML = "";
      entries.forEach((e, idx) => {
        const item = document.createElement("div");
        item.className = "entry-card";
        item.innerHTML = `
          <div class="left-col">
            <div class="rank-line">#${idx+1}</div>
            <div class="team-line">${e.name}</div>
            <div class="collab-line">${e.department}</div>
            <div class="desc-line">${e.description}</div>
          </div>
          <div class="mid-col">
            <video src="${e.videoURL}" controls></video>
          </div>
          <div class="right-col">
            <div class="score-big">${e.avg ? e.avg.toFixed(1) : "-"}</div>
            <div class="score-label">Avg Score</div>
          </div>
        `;
        listEl.appendChild(item);
      });

      statusEl.textContent = "‚úÖ Leaderboard loaded.";
    }

    loadLeaderboard();
  </script>
</body>
</html>
