<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Leaderboard â€¢ Lenbrookâ€™s Got Talent</title>
<style>
  :root {
    --bg-grad-start: #0a1424;
    --bg-grad-end: #1d2a44;
    --card-bg: rgba(255,255,255,0.07);
    --card-border: rgba(255,255,255,0.22);
    --card-shadow: 0 30px 80px rgba(0,0,0,0.6);
    --accent: #4da3ff;
    --text-primary: #ffffff;
    --text-dim: rgba(255,255,255,0.6);
    --radius-xl: 20px;
  }

  * {
    box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
  }

  body {
    margin: 0;
    min-height: 100vh;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Inter", "SF Pro Text", Roboto, "Helvetica Neue", Arial, sans-serif;
    color: var(--text-primary);
    background: radial-gradient(circle at 20% 20%, rgba(90,130,255,0.25) 0%, rgba(0,0,0,0) 60%),
                radial-gradient(circle at 80% 30%, rgba(255,0,180,0.12) 0%, rgba(0,0,0,0) 60%),
                radial-gradient(circle at 50% 80%, rgba(0,255,170,0.08) 0%, rgba(0,0,0,0) 60%),
                linear-gradient(160deg, var(--bg-grad-start) 0%, var(--bg-grad-end) 100%);
    position: relative;
    overflow-x: hidden;
    padding-bottom: 80px;
  }

  .snow-layer {
    pointer-events: none;
    position: fixed;
    inset: 0;
    background-image: radial-gradient(circle at 20px 20px, rgba(255,255,255,0.9) 0 2px, transparent 3px),
                      radial-gradient(circle at 80px 60px, rgba(255,255,255,0.5) 0 1px, transparent 2px),
                      radial-gradient(circle at 200px 120px, rgba(255,255,255,0.8) 0 1.5px, transparent 2px);
    background-size: 250px 250px;
    animation: snowFloat 6s linear infinite;
    opacity: 0.45;
    mix-blend-mode: screen;
    z-index: 5;
  }
  @keyframes snowFloat {
    0%   { background-position-y: 0px;   }
    100% { background-position-y: 250px; }
  }

  header.topbar {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 20px 24px;
    position: relative;
    z-index: 20;
  }

  .logo-wrap {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .logo-img {
    width: 72px;
    height: 72px;
    object-fit: contain;
    border-radius: 12px;
    background: rgba(255,255,255,0.07);
    box-shadow: 0 20px 40px rgba(0,0,0,0.6);
    border: 1px solid rgba(255,255,255,0.2);
  }

  .brand-block {
    display: flex;
    flex-direction: column;
    line-height: 1.2;
  }

  .brand-title {
    font-size: clamp(1rem, 0.25vw + 0.9rem, 1.05rem);
    font-weight: 600;
    color: var(--text-primary);
    display: flex;
    align-items: baseline;
    gap: 6px;
  }

  .brand-sub {
    color: var(--text-dim);
    font-size: 0.8rem;
    font-weight: 400;
  }

  main.page {
    max-width: 900px;
    margin: 0 auto;
    padding: 0 24px 40px;
    position: relative;
    z-index: 20;
  }

  .leader-card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    box-shadow: var(--card-shadow);
    backdrop-filter: blur(24px) saturate(140%);
    -webkit-backdrop-filter: blur(24px) saturate(140%);
    border-radius: var(--radius-xl);
    padding: 24px;
    margin-top: 16px;
  }

  h1 {
    margin: 0;
    font-size: 1.15rem;
    font-weight: 600;
    color: var(--text-primary);
    letter-spacing: -0.03em;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    align-items: baseline;
  }

  .subtitle {
    font-size: 0.85rem;
    line-height: 1.4;
    color: var(--text-dim);
    margin: 8px 0 16px;
  }

  .board-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .board-item {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    background: rgba(0,0,0,0.25);
    border: 1px solid rgba(255,255,255,0.12);
    border-radius: 14px;
    padding: 16px 18px;
    box-shadow: 0 30px 80px rgba(0,0,0,0.6);
    margin-bottom: 12px;
  }

  .left-block {
    display: grid;
    gap: 4px;
    max-width: 70%;
  }

  .rank-line {
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--accent);
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .team-name {
    font-size: 1rem;
    color: #fff;
    font-weight: 600;
    line-height: 1.3;
  }

  .desc-line {
    font-size: 0.8rem;
    color: var(--text-dim);
    line-height: 1.4;
  }

  .score-block {
    text-align: right;
    min-width: 70px;
  }

  .score-label {
    font-size: 0.7rem;
    color: var(--text-dim);
    font-weight: 400;
  }

  .score-value {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--accent);
    line-height: 1.2;
  }

  .santa {
    position: fixed;
    right: 16px;
    bottom: 16px;
    font-size: 2.4rem;
    filter: drop-shadow(0 6px 12px rgba(0,0,0,0.7));
    user-select: none;
    z-index: 40;
  }

  @media (max-width:480px){
    .logo-img { width:60px; height:60px; }
    .score-value { font-size:1rem; }
  }
</style>
</head>
<body>
<div class="snow-layer"></div>

<header class="topbar">
  <div class="logo-wrap">
    <img src="logo.png" alt="Lenbrook's Got Talent" class="logo-img" />
    <div class="brand-block">
      <div class="brand-title">
        <span>Lenbrookâ€™s Got Talent</span>
        <span style="color:var(--text-dim);font-weight:400;">Leaderboard</span>
      </div>
      <div class="brand-sub">Presented by Party Patrol</div>
    </div>
  </div>
</header>

<main class="page">
  <section class="leader-card">
    <h1>Holiday Showcase Rankings ðŸŽ„</h1>
    <p class="subtitle">
      Sorted by overall average score from the judges.
    </p>

    <ul id="boardList" class="board-list"></ul>
  </section>
</main>

<div class="santa">ðŸŽ…</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

  // same config
  const firebaseConfig = {
    apiKey: "AIzaSyCzXbIghLheIWJHEgCCI_oOe5finmUIe1U",
    authDomain: "lenbrook-s-got-talent.firebaseapp.com",
    projectId: "lenbrook-s-got-talent",
    storageBucket: "lenbrook-s-got-talent.firebasestorage.app",
    messagingSenderId: "327419181483",
    appId: "1:327419181483:web:c78bde1ba35d3bf037faee"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const listEl = document.getElementById("boardList");

  async function loadLeaderboard() {
    const snap = await getDocs(collection(db, "submissions"));
    const rows = [];
    snap.forEach(docSnap => {
      const data = docSnap.data();
      rows.push({
        name: data.name || "(no name)",
        departments: data.departments || "",
        description: data.description || "",
        avg: data.averageScore || 0
      });
    });

    // sort desc by avg
    rows.sort((a,b) => b.avg - a.avg);

    // render
    listEl.innerHTML = "";
    rows.forEach((row, idx) => {
      const li = document.createElement("li");
      li.className = "board-item";
      li.innerHTML = `
        <div class="left-block">
          <div class="rank-line">
            <span>#${idx + 1}</span>
            <span style="opacity:0.7;">Top Talent</span>
          </div>
          <div class="team-name">${row.name}</div>
          <div class="desc-line">
            ${row.departments ? row.departments + " Â· " : ""}${row.description}
          </div>
        </div>
        <div class="score-block">
          <div class="score-label">Avg Score</div>
          <div class="score-value">${row.avg.toFixed(1)}</div>
        </div>
      `;
      listEl.appendChild(li);
    });
  }

  loadLeaderboard();
</script>
</body>
</html>
