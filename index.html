<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lenbrook's Got Talent üéÑ | Submit Your Video</title>

  <style>
    :root {
      --bg-grad-top: #b30000;
      --bg-grad-bottom: #330000;
      --card-bg: rgba(255,255,255,0.95);
      --accent: #d4af37; /* gold */
      --text-dark: #2b2b2b;
      --btn-bg: #c91c1c;
      --btn-bg-hover: #9e1515;
    }

    /* full-page festive gradient */
    body {
      margin: 0;
      background: radial-gradient(circle at 20% 20%, var(--bg-grad-top) 0%, var(--bg-grad-bottom) 70%);
      color: #fff;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* tiny snowflakes */
    .snowflake {
      position: fixed;
      top: -10px;
      color: rgba(255,255,255,0.8);
      font-size: 12px;
      pointer-events: none;
      animation-name: fall;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
    }
    @keyframes fall {
      0% { transform: translateY(-10px) translateX(0); opacity: 1; }
      100% { transform: translateY(110vh) translateX(30px); opacity: 0; }
    }

    header {
      display: flex;
      align-items: flex-start;
      padding: 20px 24px 0;
      position: relative;
      flex-wrap: wrap;
      color: #fff;
    }

    header img.logo {
      width: 72px;
      height: 72px;
      object-fit: contain;
      border-radius: 12px;
      background: rgba(255,255,255,0.1);
      box-shadow: 0 12px 30px rgba(0,0,0,0.5);
    }

    .title-block {
      margin-left: 16px;
      flex: 1;
      min-width: 200px;
    }

    .event-title {
      font-size: 1.4rem;
      font-weight: 700;
      color: #fff;
      line-height: 1.2;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 8px;
    }

    .badge {
      background: rgba(212,175,55,0.15);
      color: var(--accent);
      border: 1px solid rgba(212,175,55,0.5);
      border-radius: 999px;
      font-size: 0.7rem;
      font-weight: 600;
      padding: 4px 10px;
      line-height: 1.2;
    }

    .presented {
      font-size: 0.8rem;
      font-weight: 500;
      color: var(--accent);
      margin-top: 4px;
      letter-spacing: 0.02em;
    }

    main {
      flex: 1;
      display: flex;
      justify-content: center;
      padding: 24px;
    }

    .card {
      width: 100%;
      max-width: 420px;
      background: var(--card-bg);
      border-radius: 20px;
      box-shadow:
        0 30px 60px rgba(0,0,0,0.6),
        0 0 20px rgba(212,175,55,0.4) inset;
      padding: 24px 24px 32px;
      color: var(--text-dark);
      position: relative;
      border: 2px solid rgba(212,175,55,0.4);
    }

    .card h2 {
      color: var(--text-dark);
      text-align: center;
      font-size: 1.2rem;
      font-weight: 700;
      margin: 0 0 4px;
    }

    .card .subhead {
      text-align: center;
      font-size: 0.9rem;
      color: #555;
      font-weight: 500;
      margin-bottom: 20px;
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    label {
      font-size: 0.8rem;
      font-weight: 600;
      color: #444;
      display: flex;
      flex-direction: column;
      text-align: left;
    }

    input[type="text"],
    textarea,
    input[type="file"] {
      margin-top: 6px;
      width: 100%;
      border-radius: 10px;
      border: 2px solid #ddd;
      font-size: 0.9rem;
      padding: 10px 12px;
      font-family: inherit;
      background-color: #fff;
    }

    textarea {
      min-height: 70px;
      resize: vertical;
    }

    button[type="submit"] {
      background: var(--btn-bg);
      color: #fff;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      padding: 12px 16px;
      cursor: pointer;
      box-shadow: 0 12px 24px rgba(201,28,28,0.4);
      transition: background 0.15s;
    }

    button[type="submit"]:hover {
      background: var(--btn-bg-hover);
    }

    #statusMsg {
      margin-top: 16px;
      text-align: center;
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--text-dark);
      min-height: 1.2em;
    }

    footer {
      text-align: center;
      color: rgba(255,255,255,0.8);
      font-size: 0.75rem;
      padding: 24px 16px 40px;
      line-height: 1.4;
    }

    @media (max-width:480px){
      header {
        flex-direction: row;
        align-items: flex-start;
      }
      header img.logo {
        width: 60px;
        height: 60px;
      }
      .event-title {
        font-size: 1.1rem;
      }
    }
  </style>
</head>
<body>

  <!-- ‚ùÑ snow layer -->
  <!-- we make ~15 flakes with random positions using inline style -->
  <script>
    for (let i = 0; i < 15; i++) {
      const delay = (Math.random()*5).toFixed(2);
      const duration = (6+Math.random()*6).toFixed(2);
      const left = (Math.random()*100).toFixed(2);
      document.write(
        `<div class="snowflake" style="
          left:${left}vw;
          animation-delay:${delay}s;
          animation-duration:${duration}s;
        ">‚úª</div>`
      );
    }
  </script>

  <header>
    <img src="logo.png" alt="Lenbrook's Got Talent" class="logo" />
    <div class="title-block">
      <div class="event-title">
        <span>Lenbrook's Got Talent</span>
        <span class="badge">Holiday Edition ‚ùÑ</span>
      </div>
      <div class="presented">Presented by Party Patrol</div>
    </div>
  </header>

  <main>
    <div class="card">
      <h2>Submit Your Performance Video</h2>
      <div class="subhead">Show us your talent for the Christmas Lunch üéÅ</div>

      <form id="submissionForm" enctype="multipart/form-data">
        <label>
          Team / Participant Name *
          <input type="text" name="name" placeholder="e.g. Finance Carolers or Jane D." required />
        </label>

        <label>
          Description of Your Act *
          <textarea name="description" placeholder="What are you performing? Song, skit, dance, etc." required></textarea>
        </label>

        <label>
          Upload Video *
          <input type="file" name="video" accept="video/*" required />
        </label>

        <button type="submit">üé¨ Upload My Talent</button>
      </form>

      <p id="statusMsg"></p>
    </div>
  </main>

  <footer>
    üéÑ Lenbrook Christmas Lunch Event &nbsp;‚Ä¢&nbsp; Internal Only
  </footer>

  <script>
    // IMPORTANT:
    // We are keeping your current upload flow:
    //   - POST the formData to Cloud Function endpoint that streams to Storage
    //   - That function writes Firestore doc with name/description/videoURL/timestamp
    // same URL as before

    const FUNCTION_URL = "https://uploadvideo-43f5xuljna-uc.a.run.app/"; // <-- your existing deployed express/CF URL
    const form = document.getElementById("submissionForm");
    const statusMsg = document.getElementById("statusMsg");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      statusMsg.textContent = "Uploading video... please wait ‚è≥";

      const formData = new FormData(form);

      try {
        const response = await fetch(FUNCTION_URL, {
          method: "POST",
          body: formData
        });

        const text = await response.text();
        let result;
        try {
          result = JSON.parse(text);
        } catch {
          throw new Error(text);
        }

        if (response.ok) {
          statusMsg.textContent = "‚úÖ Submission received! Thank you!";
          form.reset();
        } else {
          statusMsg.textContent = "‚ùå Error: " + (result.error || "Unknown error");
        }
      } catch (err) {
        statusMsg.textContent = "‚ùå Upload failed: " + err.message;
      }
    });
  </script>
</body>
</html>
